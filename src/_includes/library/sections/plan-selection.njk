<!-- prettier-ignore -->
{% set title = plan_selection.title | default('No title') %}
{% set desc = plan_selection.desc | default('No description "desc" added currently.') %}
{% set price_toggle = plan_selection.price_toggle or false %}

<!-- prettier-ignore -->
{% set plans = plan_selection.plans %}

<!-- prettier-ignore -->
<section class="plan-selection">
  <h2 class="plan-selection__title">{{title}}</h2>
  <p class="plan-selection__desc">{{desc}}</p>

  {% if price_toggle %}
  <div class="plan-selection__toggle-wrapper">
    <div class="plan-selection__toggle toggle-slider toggle-slider--solid">
      <button 
        class="plan-selection__toggle-option"
        data-toggle-option="start"
        aria-selected="true"
      >
        Monthly
      </button>
      <button 
        class="plan-selection__toggle-option"
        data-toggle-option="end"
      >
        Quarterly
      </button>
      <div class="plan-selection__toggle-slider"></div>
    </div>
    {% set tooltip = ({
      message: 'Save 20% with quarterly billing!',
      size: 'xs',
      place: 'right',
      place_sm: 'bottom',
      include_point: true
    }) %}
    {% include "../components/tooltip.njk" %}
  </div>
  {% endif %}

  <div class="plan-options">
    {% for obj in plans %}
      {% set plan = obj %}
      {% set title = plan.title | default('No plan title') %}
      {% set price_mo = plan.price_mo | default('No monthly price') %}
      {% set price_qt = plan.price_qt | default('No quarterly price') %}
      {% set grand_total = plan.grand_total | default('No grand total') %}
      {% set savings_qt = plan.savings_qt | default('No grand savings') %}
  
      <div class="plan-option">
        <h3 class="plan-option__title h2">{{ title }}</h3>
        
        <p class="plan-option__price">
          <span class="plan-option__price-currency">$</span>
          <span 
            class="plan-option__price-cost glitch-text"
            data-toggle-target 
            data-toggle-end="{{price_qt}}"
            aria-live="polite"
          >
          {{ price_mo }}
          </span>
          <span class="plan-option__price-frequency">/month</span>
        </p>

        <p class="plan-option__total glitch-text">
          <span>$</span>
          <span 
            class="plan-option__total-swap" 
            data-toggle-target 
            data-toggle-end="{{ grand_total }}"
            aria-live="polite"
          >{{ price_mo }}</span>
          <span>Billed</span>
          <span 
            class="plan-option__total-frequency" 
            data-toggle-target 
            data-toggle-end="quarterly"
          >          
            monthly
          </span>
        </p>

        <ul class="plan-option__perks">
          {% for perk in plan.features %}
            <li>{{perk}}</li>
          {% endfor %}
        </ul>

        <p
          class="plan-option__message glitch-text" 
          data-toggle-target 
          data-toggle-end="Youâ€™re saving {{ savings_qt }} quarterly!"
          aria-live="polite"
        >
          Save 20% with quarterly billing!
        </p>

        {% set btn = ({
          text: 'hello',
          type: 'solid'
        }) %}
        {% include "../../components/btn.njk" %}
      </div>
    {% endfor %}
  </div>
</section>
